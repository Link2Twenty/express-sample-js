<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: apod.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: apod.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import BaseRoute from './base.js';

const { DEMO_KEY } = Object.assign({ DEMO_KEY: 'DEMO_KEY' }, process.env);

/**
 * @module routes:apod
 * @description Astronomy Picture of the Day (APOD) route.
 */

export default class ApodRoute extends BaseRoute {
  constructor(router) {
    super('/apod', router);
  }

  init() {
    this.get('/:count', this.getApod);
  }

  /**
   * @member
   *
   * @summary GET ./apod/:count
   * @desc Retrieves the Astronomy Picture of the Day (APOD).
   *
   * @param {string} req.params.count - The number of APOD entries to retrieve.
   *
   * @returns 200 - Success - Returns an object with 'data' and 'error' properties.
   * @returns 500 - Internal Server Error - An error occurred while processing the request.
   *
   * @example Request:
   * GET http://localhost:5000/apod/1
   *
   * @example Success response:
   * {
   *  "data": [
   *    {
   *      "title": "Galaxy Wars: M81 versus M82",
   *      "explanation": "In this stunning cosmic vista, galaxy M81 is on the left surrounded by blue spiral arms.  On the right marked by massive gas and dust clouds, is M82.  These two mammoth galaxies have been locked in gravitational combat for the past billion years.   The gravity from each galaxy dramatically affects the other during each hundred million-year pass.  Last go-round, M82's gravity likely raised density waves rippling around M81, resulting in the richness of M81's spiral arms.  But M81 left M82 with violent star forming regions and colliding gas clouds so energetic the galaxy glows in X-rays.  In a few billion years only one galaxy will remain.",
   *      "hdurl": "https://apod.nasa.gov/apod/image/0604/M81_M82_schedler_c80.jpg",
   *      "copyright": "Panther Observatory",
   *      "date": "2006-04-15",
   *    },
   *  ],
   *  "error": null
   * }
   *
   * @example Error response:
   * {
   *  "data": null,
   *  "error": "An error occurred."
   * }
   */
  async getApod(req, res) {
    const { count } = req.params;

    const response = await fetch(`https://api.nasa.gov/planetary/apod?api_key=${DEMO_KEY}&amp;count=${count}`, {
      method: 'GET',
      headers: { 'Content-Type': 'application/json' }
    });

    const json = await response.json();

    // validate the response
    if (!response.ok) throw new Error(response.statusText);
    if (!json || !Array.isArray(json)) throw new Error('Invalid response format.');
    if (json.length === 0) throw new Error('No data found.', { cause: { status: 404 } });

    // transform the data to match the expected format
    const data = json.map((item) => ({
      title: item.title,
      explanation: item.explanation,
      hdurl: item.hdurl,
      copywrite: item.copyright,
      date: item.date
    }));

    res.json({ data, error: null });
  }
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="routes_apod.html">routes:apod</a></li><li><a href="routes_testCrud.html">routes:testCrud</a></li></ul><h3>Global</h3><ul><li><a href="global.html#init">init</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Sun Mar 30 2025 16:52:45 GMT+0100 (British Summer Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
